import json
import boto3

def lambda_handler(event, context):
    client = boto3.client('ec2')
    client.request_spot_instances(
        InstanceCount=1,
        LaunchSpecification={
            'EbsOptimized': False,
            'IamInstanceProfile': {
                'Arn': 'arn:aws:iam::722137132705:instance-profile/minecraft'
            },
            'ImageId': 'ami-0de53d8956e8dcf80',
            'InstanceType': 'm3.large',
            'KeyName': 'minecraftkey',
            'NetworkInterfaces': [
                {
                    'NetworkInterfaceId': 'eni-0f016f710ea0c6fad',
                    'DeviceIndex': 0
                },
            ],
            'UserData': 'IyEvYmluL2Jhc2gKCnl1bSB1cGRhdGUgLXkKeXVtIGluc3RhbGwgamF2YSAteQp5dW0gaW5zdGFsbCBqcSAteQoKbWtkaXIgL21pbmVjcmFmdHNlcnZlcgpjZCAvbWluZWNyYWZ0c2VydmVyCgojdXNpbmcgbWluZWNyYWZ0IHNlcnZlciB2ZXJzaW9uIDEuMTQuMgpjdXJsIGh0dHBzOi8vbGF1bmNoZXIubW9qYW5nLmNvbS92MS9vYmplY3RzLzgwOGJlMzg2OWUyY2E2YjYyMzc4ZjlmNGIzM2M5NDY2MjE2MjAwMTkvc2VydmVyLmphciA+IC9taW5lY3JhZnRzZXJ2ZXIvc2VydmVyLmphcgoKY2htb2QgK3ggL21pbmVjcmFmdHNlcnZlci9zZXJ2ZXIuamFyCmVjaG8gImV1bGE9dHJ1ZSIgPiAvbWluZWNyYWZ0c2VydmVyL2V1bGEudHh0CmF3cyBzMyBzeW5jIHMzOi8vY3JhaW53ZW1pbmVjcmFmdGJ1Y2tldC9taW5lY3JhZnRzZXJ2ZXIvd29ybGQgL21pbmVjcmFmdHNlcnZlci93b3JsZCB8fCBlY2hvICJubyB3b3JsZCBkaXJlY3RvcnkgaW4gczMiCmF3cyBzMyBjcCBzMzovL2NyYWlud2VtaW5lY3JhZnRidWNrZXQvbWluZWNyYWZ0c2VydmVyL2Jhbm5lZC1pcHMuanNvbiAvbWluZWNyYWZ0c2VydmVyL2Jhbm5lZC1pcHMuanNvbiB8fCBlY2hvICJubyBiYW5uZWQtaXBzLmpzb24gZmlsZSBpbiBzMyIKYXdzIHMzIGNwIHMzOi8vY3JhaW53ZW1pbmVjcmFmdGJ1Y2tldC9taW5lY3JhZnRzZXJ2ZXIvYmFubmVkLXBsYXllcnMuanNvbiAvbWluZWNyYWZ0c2VydmVyL2Jhbm5lZC1wbGF5ZXJzLmpzb24gfHwgZWNobyAibm8gYmFubmVkLXBsYXllcnMuanNvbiBmaWxlIGluIHMzIgphd3MgczMgY3AgczM6Ly9jcmFpbndlbWluZWNyYWZ0YnVja2V0L21pbmVjcmFmdHNlcnZlci9vcHMuanNvbiAvbWluZWNyYWZ0c2VydmVyL29wcy5qc29uIHx8IGVjaG8gIm5vIG9wcy5qc29uIGZpbGUgaW4gczMiCmF3cyBzMyBjcCBzMzovL2NyYWlud2VtaW5lY3JhZnRidWNrZXQvbWluZWNyYWZ0c2VydmVyL3NlcnZlci5wcm9wZXJ0aWVzIC9taW5lY3JhZnRzZXJ2ZXIvc2VydmVyLnByb3BlcnRpZXMgfHwgZWNobyAibm8gc2VydmVyLnByb3BlcnRpZXMgZmlsZSBpbiBzMyIKYXdzIHMzIGNwIHMzOi8vY3JhaW53ZW1pbmVjcmFmdGJ1Y2tldC9taW5lY3JhZnRzZXJ2ZXIvdXNlcmNhY2hlLmpzb24gL21pbmVjcmFmdHNlcnZlci91c2VyY2FjaGUuanNvbiB8fCBlY2hvICJubyB1c2VyY2FjaGUuanNvbiBmaWxlIGluIHMzIgphd3MgczMgY3AgczM6Ly9jcmFpbndlbWluZWNyYWZ0YnVja2V0L21pbmVjcmFmdHNlcnZlci93aGl0ZWxpc3QuanNvbiAvbWluZWNyYWZ0c2VydmVyL3doaXRlbGlzdC5qc29uIHx8IGVjaG8gIm5vIHdoaXRlbGlzdC5qc29uIGZpbGUgaW4gczMiCgplY2hvICIwICogKiAqICogYXdzIHMzIHN5bmMgL21pbmVjcmFmdHNlcnZlci93b3JsZCBzMzovL2NyYWlud2VtaW5lY3JhZnRidWNrZXQvbWluZWNyYWZ0c2VydmVyL3dvcmxkIiA+IC92YXIvc3Bvb2wvY3Jvbi9yb290CmVjaG8gIjAgKiAqICogKiBhd3MgczMgY3AgL21pbmVjcmFmdHNlcnZlci9iYW5uZWQtaXBzLmpzb24gczM6Ly9jcmFpbndlbWluZWNyYWZ0YnVja2V0L21pbmVjcmFmdHNlcnZlci9iYW5uZWQtaXBzLmpzb24iID4+IC92YXIvc3Bvb2wvY3Jvbi9yb290CmVjaG8gIjAgKiAqICogKiBhd3MgczMgY3AgL21pbmVjcmFmdHNlcnZlci9iYW5uZWQtcGxheWVycy5qc29uIHMzOi8vY3JhaW53ZW1pbmVjcmFmdGJ1Y2tldC9taW5lY3JhZnRzZXJ2ZXIvYmFubmVkLXBsYXllcnMuanNvbiIgPj4gL3Zhci9zcG9vbC9jcm9uL3Jvb3QKZWNobyAiMCAqICogKiAqIGF3cyBzMyBjcCAvbWluZWNyYWZ0c2VydmVyL29wcy5qc29uIHMzOi8vY3JhaW53ZW1pbmVjcmFmdGJ1Y2tldC9taW5lY3JhZnRzZXJ2ZXIvb3BzLmpzb24iID4+IC92YXIvc3Bvb2wvY3Jvbi9yb290CmVjaG8gIjAgKiAqICogKiBhd3MgczMgY3AgL21pbmVjcmFmdHNlcnZlci9zZXJ2ZXIucHJvcGVydGllcyBzMzovL2NyYWlud2VtaW5lY3JhZnRidWNrZXQvbWluZWNyYWZ0c2VydmVyL3NlcnZlci5wcm9wZXJ0aWVzIiA+PiAvdmFyL3Nwb29sL2Nyb24vcm9vdAplY2hvICIwICogKiAqICogYXdzIHMzIGNwIC9taW5lY3JhZnRzZXJ2ZXIvdXNlcmNhY2hlLmpzb24gczM6Ly9jcmFpbndlbWluZWNyYWZ0YnVja2V0L21pbmVjcmFmdHNlcnZlci91c2VyY2FjaGUuanNvbiIgPj4gL3Zhci9zcG9vbC9jcm9uL3Jvb3QKZWNobyAiMCAqICogKiAqIGF3cyBzMyBjcCAvbWluZWNyYWZ0c2VydmVyL3doaXRlbGlzdC5qc29uIHMzOi8vY3JhaW53ZW1pbmVjcmFmdGJ1Y2tldC9taW5lY3JhZnRzZXJ2ZXIvd2hpdGVsaXN0Lmpzb24iID4+IC92YXIvc3Bvb2wvY3Jvbi9yb290CgpjYXQgPDxFT0YgPiAvYXV0b3NodXRkb3duLnNoCiMhL2Jpbi9iYXNoCgptaW51dGVzTm90Q29ubmVjdGVkPTAKCndoaWxlIHRydWUKZG8KCnNsZWVwIDYwCgpwbGF5ZXJzQ29ubmVjdGVkPVwkKG5ldHN0YXQgLWFucCB8IGdyZXAgOjI1NTY1IHwgZ3JlcCBFU1RBQkxJU0hFRCB8IHdjIC1sKQoKaWYgWyBcJHtwbGF5ZXJzQ29ubmVjdGVkfSAtZ3QgMCBdCnRoZW4KICBlY2hvICJcJHtwbGF5ZXJzQ29ubmVjdGVkfSBwbGF5ZXJzIGFyZSBjb25uZWN0ZWQgdG8gdGhlIHNlcnZlci4iCiAgbWludXRlc05vdENvbm5lY3RlZD0wCmVsc2UKICAoKG1pbnV0ZXNOb3RDb25uZWN0ZWQrKykpCiAgZWNobyAibm8gb25lIGhhcyBiZWVuIGNvbm5lY3RlZCBmb3IgXCR7bWludXRlc05vdENvbm5lY3RlZH0gbWludXRlcy4iCiAgaWYgWyBcJHttaW51dGVzTm90Q29ubmVjdGVkfSAtZ3QgMzAgXSAmJiBbIFwkKGRhdGUgKyIlTSIpIC1lcSA1IF0KICB0aGVuCiAgICBlY2hvICJzaHV0dGluZyBkb3duIHRoZSBzZXJ2ZXIiCiAgICBhd3MgZWMyIGNhbmNlbC1zcG90LWluc3RhbmNlLXJlcXVlc3RzIC0tc3BvdC1pbnN0YW5jZS1yZXF1ZXN0LWlkcyBgYXdzIGVjMiBkZXNjcmliZS1pbnN0YW5jZXMgLS1maWx0ZXJzICJOYW1lPXRhZzpOYW1lLFZhbHVlcz1NaW5lY3JhZnQsTmFtZT1pbnN0YW5jZS1zdGF0ZS1uYW1lLFZhbHVlcz1ydW5uaW5nIiAtLXJlZ2lvbiB1cy1lYXN0LTEgfCBqcSAuUmVzZXJ2YXRpb25zW10uSW5zdGFuY2VzW10uU3BvdEluc3RhbmNlUmVxdWVzdElkIC1yYCAtLXJlZ2lvbiB1cy1lYXN0LTEKCWF3cyBlYzIgdGVybWluYXRlLWluc3RhbmNlcyAtLWluc3RhbmNlLWlkcyBgYXdzIGVjMiBkZXNjcmliZS1pbnN0YW5jZXMgLS1maWx0ZXJzICJOYW1lPXRhZzpOYW1lLFZhbHVlcz1NaW5lY3JhZnQsTmFtZT1pbnN0YW5jZS1zdGF0ZS1uYW1lLFZhbHVlcz1ydW5uaW5nIiAtLXJlZ2lvbiB1cy1lYXN0LTEgfCBqcSAuUmVzZXJ2YXRpb25zW10uSW5zdGFuY2VzW10uSW5zdGFuY2VJZCAtcmAgLS1yZWdpb24gdXMtZWFzdC0xCiAgZmkKZmkKCmRvbmUKRU9GCgpzaCAvYXV0b3NodXRkb3duLnNoICY+L2F1dG9zaHV0ZG93bi5sb2cgJgoKYXdzIGVjMiBjcmVhdGUtdGFncyAtLXJlc291cmNlcyBgY3VybCAxNjkuMjU0LjE2OS4yNTQvbGF0ZXN0L21ldGEtZGF0YS9pbnN0YW5jZS1pZGAgLS10YWdzIEtleT1OYW1lLFZhbHVlPU1pbmVjcmFmdCAtLXJlZ2lvbiB1cy1lYXN0LTEKCmphdmEgLWQ2NCAtWG14NkcgLVhtczZHIC1YbW43NjhtIC1YWDorRGlzYWJsZUV4cGxpY2l0R0MgLVhYOitVc2VDb25jTWFya1N3ZWVwR0MgLVhYOitVc2VQYXJOZXdHQyAtWFg6K1VzZU5VTUEgLVhYOitDTVNQYXJhbGxlbFJlbWFya0VuYWJsZWQgLVhYOk1heFRlbnVyaW5nVGhyZXNob2xkPTE1IC1YWDpNYXhHQ1BhdXNlTWlsbGlzPTMwIC1YWDpHQ1BhdXNlSW50ZXJ2YWxNaWxsaXM9MTUwIC1YWDorVXNlQWRhcHRpdmVHQ0JvdW5kYXJ5IC1YWDotVXNlR0NPdmVyaGVhZExpbWl0IC1YWDorVXNlQmlhc2VkTG9ja2luZyAtWFg6U3Vydml2b3JSYXRpbz04IC1YWDpUYXJnZXRTdXJ2aXZvclJhdGlvPTkwIC1YWDpNYXhUZW51cmluZ1RocmVzaG9sZD0xNSAtRGZtbC5pZ25vcmVQYXRjaERpc2NyZXBhbmNpZXM9dHJ1ZSAtRGZtbC5pZ25vcmVJbnZhbGlkTWluZWNyYWZ0Q2VydGlmaWNhdGVzPXRydWUgLVhYOitVc2VGYXN0QWNjZXNzb3JNZXRob2RzIC1YWDorQWdncmVzc2l2ZU9wdHMgLVhYOlJlc2VydmVkQ29kZUNhY2hlU2l6ZT0yMDQ4bSAtWFg6K1VzZUNvZGVDYWNoZUZsdXNoaW5nIC1YWDpTb2Z0UmVmTFJVUG9saWN5TVNQZXJNQj0xMDAwMCAtWFg6UGFyYWxsZWxHQ1RocmVhZHM9MTAgLWphciAvbWluZWNyYWZ0c2VydmVyL3NlcnZlci5qYXI='
        },
        SpotPrice='0.04',
        Type='persistent',
        InstanceInterruptionBehavior='terminate'
    )
    return {
        'statusCode': 200,
        'body': json.dumps('Hello from Lambda!')
    }
